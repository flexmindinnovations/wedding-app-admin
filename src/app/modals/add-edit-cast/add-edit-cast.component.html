<div class="cast-modal flex flex-col h-full">
  <div class="header border-b border-b-gray-200  flex items-center justify-start">
    <div class="modal-title">
      <h1 class="m-0 text-base">{{data?.title}}</h1>
    </div>
  </div>
  <div class="body ion-padding border-b border-b-gray-200" [ngClass]="hasSubCastToggle ? 'flex-grow' : ''">
    <form [formGroup]="formGroup" class="flex flex-col items-start justify-start gap-3" [ngClass]="hasSubCastToggle ? 'min-h-64' : ''">
      <div class="flex flex-col gap-3 p-2 w-full">
        @if (religionListOptions.length) {
        <app-dropdown label="Religion" [control]="formGroupControl['religionId']" formControlName="religionId"
          [controlValue]="formGroup.get('religionId')?.value"
          (onSelectionChange)="onSelectionChange($event, 'religionId')" [options]="religionListOptions" />
        }
        <app-input label="Cast" class="flex-grow-1 w-full" type="text" [controlValue]="formGroup.get('castName')?.value"
          [control]="formGroupControl['castName']" formControlName="castName" />
        <p class="flex items-center justify-start gap-3">
          <input #hasSubCastSelector type="checkbox" id="react-option" formControlName="hasSubCast"
            (change)="handleSubCastStateChange($event)"
            class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600" />
          <span (click)="hasSubCastSelector.click()" class="text-sm">Has SubCast</span>
        </p>

        @if (hasSubCastToggle) {
        <div class="cast-list w-full flex flex-col items-start justify-start">
          <div class="add-cast w-[98%] pl-3 mr-auto py-2 flex items-center justify-between">
            <p>Add SubCast: <span class="text-xs opacity-70">(Maximum 10 items can be added)</span></p>
            <mt-button [title]="'Add Row'" [disabled]="subCastList.length === 10" [iconOnly]="true" [isCancel]="true"
              [icon]="'pi pi-plus'" [size]="'large'" (action)="handleAddRowClick($event)" />
          </div>
          <div class="list-container w-full max-h-72 overflow-auto ion-padding" formArrayName="subCastList">
            @for (item of subCastFormGroup.controls; track $index) {
            <div class="specialization-item w-full flex items-end justify-between gap-5 mb-3" [formGroupName]="$index">
              <app-input [label]="'Sub Cast'" [controlValue]="item?.get('subCastName')?.value"
                class="flex-grow-1 w-full" type="text" [control]="item?.get('subCastName')"
                (inputValue)="handleInputValue($event, item, $index)" formControlName="subCastName" />

              <div class="remove-specialization flex items-center justify-center h-11">
                @if (subCastList.length) {
                <mt-button [iconOnly]="true" [isCancel]="true" [size]="'large'" [icon]="'pi pi-trash'"
                  (action)="handleRemoveRowClick($index)" />
                }
              </div>
            </div>
            }
          </div>
        </div>
        }
      </div>
    </form>
  </div>
  <div class="actions flex items-center h-16 justify-end p-3 gap-4">
    <mt-button [title]="'Cancel'" [isCancel]="true" [textOnly]="true" (action)="handleButtonClick($event)" />
    <mt-button [disabled]="formGroup.invalid" [title]="isEditMode ? 'Update' : 'Save'" [icon]="'pi pi-save'"
      (action)="handleButtonClick($event)" />
  </div>
</div>